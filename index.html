<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Student Management System</title>

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

<style>
body {
  background-color: #f8f9fa;
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
}

.header {
  text-align: center;
  margin-bottom: 20px;
}

.header h2 {
  font-weight: 700;
  color: #0d6efd;
}

.header p {
  color: #6c757d;
  font-size: 14px;
}

.card {
  border-radius: 12px;
  box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08);
  border: none;
}

.card-body {
  padding: 24px;
}

.form-label {
  font-weight: 600;
}

.form-control,
.form-select {
  border-radius: 8px;
}

.form-control:focus,
.form-select:focus {
  border-color: #0d6efd;
  box-shadow: 0 0 0 0.15rem rgba(13, 110, 253, 0.25);
}

.form-control[readonly] {
  background-color: #e9ecef;
  color: #6c757d;
  cursor: not-allowed;
}

.form-control:invalid,
.form-select:invalid {
  border-color: #dc3545;
}

.form-control:valid,
.form-select:valid {
  border-color: #198754;
}

.form-control:invalid:focus,
.form-select:invalid:focus {
  box-shadow: 0 0 0 0.15rem rgba(220, 53, 69, 0.25);
}

.form-control:valid:focus,
.form-select:valid:focus {
  box-shadow: 0 0 0 0.15rem rgba(25, 135, 84, 0.25);
}

.btn {
  border-radius: 8px;
  font-weight: 600;
}

.btn-sm {
  margin: 0 2px;
}

.table {
  border-radius: 10px;
  overflow: hidden;
}

.table thead th {
  text-align: center;
  vertical-align: middle;
}

.table tbody td {
  text-align: center;
  vertical-align: middle;
}

.table-hover tbody tr:hover {
  background-color: #f1f5ff;
}

.minor {
  background-color: #fff3cd !important;
}

@media (max-width: 768px) {
  table, thead, tbody, th, td, tr {
    display: block;
  }
  thead {
    display: none;
  }
  tbody tr {
    margin-bottom: 15px;
    border: 1px solid #dee2e6;
    border-radius: 10px;
    padding: 12px;
    background-color: #ffffff;
  }
  tbody td {
    text-align: left;
    padding: 6px 0;
    border: none;
    display: flex;
    justify-content: space-between;
    font-size: 14px;
  }
  tbody td::before {
    content: attr(data-label);
    font-weight: 600;
    color: #6c757d;
  }
  tbody td:last-child {
    justify-content: flex-start;
    gap: 8px;
  }
}

@media (max-width: 576px) {
  .header h2 {
    font-size: 20px;
  }
  .card-body {
    padding: 16px;
  }
}
</style>
</head>

<body class="container py-4">

<div class="header mb-3">
  <h2>ðŸŽ“ Student Management System</h2>
  <p>Midterm Activity 3 â€“ JavaScript CRUD</p>
</div>

<!-- FORM -->
<div class="card mb-4">
  <div class="card-body">
    <form id="studentForm" class="row g-3" novalidate>

      <div class="col-md-4">
        <label class="form-label">Student ID (Edit Only)</label>
        <input type="text" id="studentId" class="form-control" readonly>
      </div>

      <div class="col-md-4">
        <label class="form-label">Last Name</label>
        <input type="text" id="lastName" class="form-control" required>
      </div>

      <div class="col-md-4">
        <label class="form-label">First Name</label>
        <input type="text" id="firstName" class="form-control" required>
      </div>

      <div class="col-md-4">
        <label class="form-label">Middle Name</label>
        <input type="text" id="middleName" class="form-control">
      </div>

      <div class="col-md-4">
        <label class="form-label">Birthdate</label>
        <input type="date" id="birthdate" class="form-control" required>
      </div>

      <div class="col-md-4">
        <label class="form-label">Course</label>
        <select id="course" class="form-select" required>
          <option value="">Select Course</option>
          <option>BSIT</option>
          <option>BSCS</option>
          <option>BSEMC</option>
          <option>BSA</option>
          <option>BSBA</option>
          <option>BSHM</option>
          <option>BSTM</option>
          <option>BEED</option>
          <option>BSED</option>
          <option>BSN</option>
          <option>Criminology</option>
        </select>
      </div>

      <div class="col-md-4">
        <label class="form-label">Year Level</label>
        <select id="yearLevel" class="form-select" required>
          <option value="">Select Year Level</option>
          <option>1st Year</option>
          <option>2nd Year</option>
          <option>3rd Year</option>
          <option>4th Year</option>
        </select>
      </div>

      <div class="col-12 text-end">
        <button class="btn btn-primary px-4" id="submitBtn">
          <i class="bi bi-plus-circle"></i> Add Student
        </button>
        <button type="button" class="btn btn-secondary px-4" id="cancelBtn" style="display:none;">
          <i class="bi bi-x-circle"></i> Cancel
        </button>
      </div>

    </form>
  </div>
</div>

<!-- TABLE -->
<div class="card">
  <div class="card-body">
    <table class="table table-bordered table-hover">
      <thead class="table-primary">
        <tr>
          <th>#</th>
          <th>Student ID</th>
          <th>Name</th>
          <th>Age</th>
          <th>Course</th>
          <th>Year Level</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="studentTable"></tbody>
    </table>
  </div>
</div>

<script>
const form = document.getElementById("studentForm");
const table = document.getElementById("studentTable");
const submitBtn = document.getElementById("submitBtn");
const cancelBtn = document.getElementById("cancelBtn");

const studentId = document.getElementById("studentId");
const lastName = document.getElementById("lastName");
const firstName = document.getElementById("firstName");
const middleName = document.getElementById("middleName");
const birthdate = document.getElementById("birthdate");
const course = document.getElementById("course");
const yearLevel = document.getElementById("yearLevel");

let students = [];
let editIndex = null;

function calculateAge(date) {
  const birth = new Date(date);
  const today = new Date();
  let age = today.getFullYear() - birth.getFullYear();
  const m = today.getMonth() - birth.getMonth();
  if (m < 0 || (m === 0 && today.getDate() < birth.getDate())) age--;
  return age;
}

function displayStudents() {
  table.innerHTML = "";
  students.forEach((s, i) => {
    const age = calculateAge(s.birthdate);
    const row = document.createElement("tr");
    if (age < 18) row.classList.add("minor");
    row.innerHTML = `
      <td data-label="#">${i + 1}</td>
      <td data-label="Student ID">${s.studentId || "-"}</td>
      <td data-label="Name">${s.lastName}, ${s.firstName} ${s.middleName}</td>
      <td data-label="Age">${age}</td>
      <td data-label="Course">${s.course}</td>
      <td data-label="Year Level">${s.yearLevel}</td>
      <td data-label="Actions">
        <button class="btn btn-warning btn-sm" onclick="editStudent(${i})">
          <i class="bi bi-pencil"></i>
        </button>
        <button class="btn btn-danger btn-sm" onclick="deleteStudent(${i})">
          <i class="bi bi-trash"></i>
        </button>
      </td>
    `;
    table.appendChild(row);
  });
}

form.addEventListener("submit", function(e) {
  e.preventDefault();

  if (!form.checkValidity()) {
    form.classList.add("was-validated");
    return;
  }

  if (editIndex !== null && !studentId.value.trim()) {
    alert("Student ID is required when editing.");
    return;
  }

  const student = {
    studentId: studentId.value.trim(),
    lastName: lastName.value.trim(),
    firstName: firstName.value.trim(),
    middleName: middleName.value.trim(),
    birthdate: birthdate.value,
    course: course.value,
    yearLevel: yearLevel.value
  };

  if (editIndex === null) {
    students.push(student);
  } else {
    students[editIndex] = student;
    editIndex = null;
  }

  resetForm();
  displayStudents();
});

function editStudent(index) {
  const s = students[index];
  studentId.value = s.studentId;
  studentId.removeAttribute("readonly");
  lastName.value = s.lastName;
  firstName.value = s.firstName;
  middleName.value = s.middleName;
  birthdate.value = s.birthdate;
  course.value = s.course;
  yearLevel.value = s.yearLevel;
  editIndex = index;

  submitBtn.innerHTML = '<i class="bi bi-check-circle"></i> Update Student';
  cancelBtn.style.display = "inline-block";
}

cancelBtn.addEventListener("click", resetForm);

function deleteStudent(index) {
  if (confirm("Delete this student?")) {
    students.splice(index, 1);
    displayStudents();
  }
}

function resetForm() {
  form.reset();
  form.classList.remove("was-validated");
  studentId.value = "";
  studentId.setAttribute("readonly", true);
  submitBtn.innerHTML = '<i class="bi bi-plus-circle"></i> Add Student';
  cancelBtn.style.display = "none";
}
</script>

</body>
</html>
